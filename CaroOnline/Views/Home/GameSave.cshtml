@using CaroOnline.Helper
@using CaroOnline.Models
@model List<GameSave>
@{
    ViewBag.Title = "GameSave";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="col-lg-9 col-md-9 col-sm-12">
    <!-- Nav tabs -->
    <ul class="nav nav-tabs nav-justified indigo rounded p-2" role="tablist" style="background-image: linear-gradient(60deg, #3d3393 0%, #2b76b9 37%, #2cacd1 65%, #35eb93 100%);">
        <li class="nav-item">
            <a class="nav-link active h4-responsive" data-toggle="tab" href="#panel5" role="tab"><i class="fa fa-save mr-2"></i>CÁC TRẬN ĐÃ LƯU</a>
        </li>

    </ul>
    <!-- Tab panels -->
    <div class="tab-content grey lighten-3 card px-1 rounded pb-4" style="">
        <!--Panel 1-->
        <div class="tab-pane fade in show active" id="panel5" role="tabpanel">
            <div class="card-body px-2 ">
                <div class="row">
                    @{
                        var curName = CurrentContext.GetCurUser().Name;
                    }
                    @foreach (var item in Model)
                    {
                        <div class="col-md-6 mb-2">
                            <div class="card">
                                <div class="card-body p-0">
                                </div>
                                <blockquote class="blockquote bq-primary mb-0 p-0 ">
                                    <ul class="list-group list-group-flush">
                                        @{
                                            var target = curName == item.User1 ? item.User2 : item.User1;
                                        }
                                        <li class="list-group-item py-1 white-text primary-color"><i class="fa fa-user-circle-o"></i> Đối thủ: @target</li>
                                        <li class="list-group-item py-1"><i class="fa fa-angle-right"></i> Lượt đi: @item.Turrn</li>
                                        <li class="list-group-item py-1 d-flex justify-content-between">
                                            <span><i class="fa fa-calendar"></i> Ngày: @item.Date.Value.ToString("HH:mm - dd/MM ")</span>
                                            <button class="btn btn-outline-blue btn-sm" data-gameid="@item.ID" data-target="@target" id="reStart">Tiếp tục</button>
                                        </li>
                                        @*<li class="list-group-item py-1"></li>*@
                                    </ul>
                                </blockquote>



                            </div>

                        </div>
                                            }

                </div>
            </div>
        </div>
    </div>
    @section js{
     <script>
         $(document).ready(function () {

             $("#reStart").on('click', function () {
                 $.ajax({
                     async:false,
                     url: "/Home/CheckOnline?uName=" + $(this).data("target"),
                     success: function (data) {
                         if (data == "0") {
                             alert("Đôi thủ k online");
                         } else {
                             alert("Đang chờ đối thủ đồng ý!");
                         }
                     },
                     error: function () {
                         alert("K tìm đc đối thủ");
                     }
                 });
             });
         });

        </script>   
    
    }